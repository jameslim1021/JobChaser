{"version":3,"sources":["signup.js"],"names":[],"mappings":"AAAA;;AACA,IAAI,UAAU,QAAQ,SAAR,CAAd;AACA,IAAI,SAAS,QAAQ,MAAR,EAAb;AACA,IAAI,KAAK,QAAQ,IAAR,CAAT;AACA,IAAI,OAAO,QAAQ,YAAR,CAAX;AACA,IAAI,SAAS,QAAQ,QAAR,CAAb;;AAEA,MAAM,QAAQ,YAAW;AACvB,SAAO,KAAK,OAAL,CAAP;AACD,CAFD;;AAIA,OAAO,GAAP,CAAW,GAAX,EAAgB,UAAS,GAAT,EAAc,GAAd,EAAkB;AAChC,MAAI,MAAJ,CAAW,QAAX;AACD,CAFD;;AAIA,OAAO,IAAP,CAAY,GAAZ,EAAiB,UAAS,GAAT,EAAc,GAAd,EAAkB;AACjC,UAAQ,GAAR,CAAY,KAAZ;AACA,UAAQ,KAAR,CAAc,EAAC,OAAM,IAAI,IAAJ,CAAS,KAAhB,EAAd,EACC,KADD,GACS,IADT,CACc,UAAS,IAAT,EAAc;AAC1B,QAAG,CAAC,IAAJ,EAAU;AACR,UAAI,OAAO,OAAO,QAAP,CAAgB,IAAI,IAAJ,CAAS,QAAzB,EAAmC,CAAnC,CAAX;AACA,WAAK,OAAL,EAAc,MAAd,CAAqB;AACnB,oBAAY,IAAI,IAAJ,CAAS,SADF;AAEnB,mBAAW,IAAI,IAAJ,CAAS,QAFD;AAGnB,eAAO,IAAI,IAAJ,CAAS,KAHG;AAInB,kBAAU,IAJS;AAKnB,sBAAc,IAAI,IAAJ,CAAS;AALJ,OAArB,EAMG,SANH,CAMa,GANb,EAMkB,IANlB,CAMuB,UAAS,OAAT,EAAkB;AACvC,YAAI,QAAJ,CAAa,CAAC,MAAD,GAAS,QAAQ,CAAR,EAAW,EAApB,EAAA,AAAuB,CAApC;AACD,OARD;AASD,KAXD,MAWO;AACL,UAAI,IAAJ,CAAS,sBAAT;AACD;AACF,GAhBD,EAgBG,KAhBH,CAgBS,UAAS,GAAT,EAAc;AACrB,QAAI,IAAJ,CAAS,sBAAsB,GAA/B;AACD,GAlBD;AAmBD,CArBD;;AAuBA,OAAO,OAAP,GAAiB,MAAjB","file":"signup-compiled.js","sourcesContent":["\"use strict\";\nvar express = require(\"express\");\nvar router = express.Router();\nvar pg = require(\"pg\");\nvar knex = require(\"../db/knex\");\nvar bcrypt = require(\"bcrypt\");\n\nconst USERS = function() {\n  return knex('users');\n};\n\nrouter.get('/', function(req, res){\n  res.render('signup');\n});\n\nrouter.post('/', function(req, res){\n  console.log('foo');\n  USERS().where({email:req.body.email})\n  .first().then(function(user){\n    if(!user) {\n      var hash = bcrypt.hashSync(req.body.password, 8);\n      knex('users').insert({\n        first_name: req.body.firstName,\n        last_name: req.body.lastName,\n        email: req.body.email,\n        password: hash,\n        phone_number: req.body.phone\n      }).returning('*').then(function(newUser) {\n        res.redirect(`/user/${newUser[0].id}`);\n      });\n    } else {\n      res.send('Email already exists');\n    }\n  }).catch(function(err) {\n    res.send(\"Error signing up \" + err);\n  });\n});\n\nmodule.exports = router;\n"]}